// We can get all populations with the code below;
//name: "'; SELECT * FROM Country; --"
//code: "'; SELECT * FROM Country; --"

//OR

// SELECT Population FROM ${Country} WHERE Name = ''; DROP TABLE ${Country}; --' and code = '${code}'


// Rewrite the function so that it is no longer vulnerable to SQL injection

function getPopulation(Country, name, code, cb) {
    // assuming that connection to the database is established and stored as conn
    conn.query(
        `SELECT Population FROM ?? WHERE Name = ? and code = ?`,
        [Country, name, code],
        function (err, result) {
            if (err) cb(err);
            if (result.length == 0) cb(new Error("Not found"));
            cb(null, result[0].name);
        }
    );
}

